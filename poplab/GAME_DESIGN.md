# Bubble Pop Lab - Дизайн-документ

## Обзор

**Bubble Pop Lab (Пузырьки O₂)** - реактивная аркадная игра, где игрок лопает O₂-пузыри, избегая токсичных, накапливая серии и множители для максимальных очков.

## Основные механики

### Игровая петля
1. Пузыри спавнятся с верхней части экрана
2. Игрок тапает по O₂ пузырям для получения очков
3. Комбо и множители растут с каждым успешным тапом
4. Попадание по токсичному пузырю сбрасывает серию
5. Периодические спринт-челленджи с временными ограничениями

### Типы пузырей
- **O₂ (Кислород)** - основные пузыри, дают очки и увеличивают комбо
- **Токсичные** - сбрасывают серию и комбо
- **Нейтральные** - дают небольшое количество очков без влияния на комбо

### Система прогрессии
- **Турбулентность** - хаотичное движение пузырей (активируется периодически)
- **Гравитационные пульсы** - изменение направления движения
- **Опасности** - медузы и лезвия, уничтожающие пузыри
- **Волновой рост** - увеличение частоты спавна со временем

### Экономика
- **Очки**: базовые * множитель + бонусы за перфектные серии
- **Капсулы**: игровая валюта, зарабатывается за игры и достижения
- **Магазин**:
  - Чистый фильтр (удаляет токсичные пузыри)
  - Расширение зоны тапа
  - Замедление времени
  - Скины для лаборатории

### Игровые режимы
- **Arcade** - бесконечный режим
- **Time Attack** - 90 секунд на максимум очков
- **Daily Lab Test** - ежедневный фиксированный челлендж с сидом

### Достижения
- **Pure Air** - серия из 50 O₂ пузырей
- **Lab Hero** - завершить 3 спринта подряд
- **Toxic-Free** - игра без попаданий по токсичным
- **Oxygen Master** - лопнуть 1000 O₂ пузырей всего
- **Score Legend** - набрать 10000 очков в одной игре

## Технические требования

### Производительность
- Стабильный спавн и физика пузырей
- 60 FPS на всех устройствах
- Отзывчивый ввод (<50ms задержки)

### Метрики баланса
- Целевой APM: 120-200 тапов в минуту
- Спринты каждые 30-45 секунд
- Адаптивная сложность на основе производительности
- Окно без токсинов после фейла (grace period)

## UI/UX

### Визуальный стиль
- Лабораторная эстетика с голубыми градиентами
- Мягкие частицы и свечение для пузырей
- Четкое различие типов пузырей
- Яркие эффекты для комбо и множителей

### HUD элементы
- Счет и комбо (верхний левый угол)
- Множитель
- Таймер (для Time Attack)
- Индикатор спринт-челленджа
- Индикатор серии

### Звуковые эффекты
- Приятный "pop" при лопании O₂
- Тревожный звук при токсине
- Фоновая ambient музыка

## Definition of Done (DoD)

✅ Все режимы игры работают корректно
✅ Предсказуемое поведение пузырей и физика
✅ Корректные сбросы серии при токсинах
✅ Магазин и покупки сохраняются
✅ Достижения разблокируются правильно
✅ 60 FPS на всех экранах
✅ Локальное сохранение прогресса
✅ Адаптивная сложность работает
✅ Спринт-челленджи появляются регулярно
✅ Все UI элементы отзывчивы

## Архитектура кода

### Структура проекта
```
lib/
├── models/           # Модели данных
│   ├── bubble.dart
│   ├── game_state.dart
│   ├── player_data.dart
│   └── hazard.dart
├── services/         # Бизнес-логика
│   ├── game_engine.dart
│   ├── storage_service.dart
│   └── achievement_service.dart
├── screens/          # Экраны приложения
│   ├── menu_screen.dart
│   ├── game_screen.dart
│   ├── shop_screen.dart
│   └── achievements_screen.dart
├── widgets/          # Переиспользуемые виджеты
│   ├── bubble_widget.dart
│   ├── hazard_widget.dart
│   └── game_hud.dart
└── main.dart         # Точка входа
```

### Ключевые компоненты
- **GameEngine** - основной игровой цикл, физика, спавн
- **StorageService** - сохранение/загрузка через SharedPreferences
- **AchievementService** - проверка и разблокировка достижений

## Будущие улучшения

- Мультиплеер / глобальные лидерборды
- Больше типов пузырей (бонусные, взрывные)
- Сезонные события
- Звуковые эффекты и музыка
- Анимированные переходы между экранами
- Больше скинов и кастомизации
